## SQL

+ [1. Что такое первичный ключ?](#1-Что-такое-первичный-ключ)
+ [2. Что такое внешний ключ?](#2-Что-такое-внешний-ключ)
+ [3. Что такое нормализация БД?](#3-Что-такое-нормализация-БД)
+ [4. Что такое денормализация БД? Для чего она нужна?](#4-Что-такое-денормализация-БД-Для-чего-она-нужна)
+ [5. Что такое кластерный и некластерный индекс?](#5-Что-такое-кластерный-и-некластерный-индекс)
+ [6. Какие типы соединений join таблиц существуют? В чем их разница?](#6-Какие-типы-соединений-join-таблиц-существуют-В-чем-их-разница)
+ [7. Что такое SQL курсор?](#7-Что-такое-SQL-курсор)
+ [8. Опишите шаги по созданию и использованию курсора?](#8-Опишите-шаги-по-созданию-и-использованию-курсора)
+ [10. Что такое транзакция?](#10-Что-такое-транзакция)
+ [11. Что такое триггер? Какие типы триггеров вы знаете?](#11-Что-такое-триггер-Какие-типы-триггеров-вы-знаете)
+ [12. В чем разница между WHERE и HAVING?](#12-В-чем-разница-между-WHERE-и-HAVING)
+ [13. Что такое подзапрос sub-query?](#13-Что-такое-подзапрос-sub-query)
+ [14. Что такое union?](#14-Что-такое-union)
+ [15. Что такое group by](#15-Что-такое-group-by)
+ [17. Что такое хранимые процедуры?](#17-Что-такое-хранимые-процедуры)
+ [18. Что такое view Представление?](#18-Что-такое-view-Представление)
+ [19. Опишите процесс создания запроса через JDBC.](#19-Опишите-процесс-создания-запроса-через-JDBC)
+ [20. Для чего используется конструкция try-with-resources.](#20-Для-чего-используется-конструкция-try-with-resources)

+ [1. ANSI SQL](#1-ANSI-SQL)
+ [2. Основные элементы баз данных – таблицы, процедуры, функции, констрейнты и т.д..](#2-Основные-элементы-баз-данных-–-таблицы-процедуры-функции-констрейнты-и-тд)
+ [3. Как вы понимаете null в базах данных?](#3-Как-вы-понимаете-null-в-базах-данных)
+ [4. Агрегатные функции, как они работают с null. Не забудьте о group by и having](#4-Агрегатные-функции-как-они-работают-с-null-Не-забудьте-о-group-by-и-having)
+ [5. Каким образом лучше добавлять большое количество записей в таблицу?](#5-Каким-образом-лучше-добавлять-большое-количество-записей-в-таблицу)
+ [6. Что такое первая нормальная форма и процесс нормализации? Какие бывают нормальные формы?](#6-Что-такое-первая-нормальная-форма-и-процесс-нормализации-Какие-бывают-нормальные-формы)
+ [7. В чем смысл индекса СУБД, как они устроены, как хранятся? Как бы вы реализовали тот же функционал?](#7-В-чем-смысл-индекса-СУБД-как-они-устроены-как-хранятся-Как-бы-вы-реализовали-тот-же-функционал)
+ [8. Что такое JDBC API и когда его используют?](#8-Что-такое-JDBC-API-и-когда-его-используют)
+ [9. Что такое JDBC Driver и какие различные типы драйверов JDBC вы знаете?](#9-Что-такое-JDBC-Driver-и-какие-различные-типы-драйверов-JDBC-вы-знаете)
+ [10. Как JDBC API помогает достичь слабой связи между Java программой и JDBC Drivers API?](#10-Как-JDBC-API-помогает-достичь-слабой-связи-между-Java-программой-и-JDBC-Drivers-API)
+ [11. Что такое JDBC Connection? Покажите шаги для подключения программы к базе данных.](#11-Что-такое-JDBC-Connection-Покажите-шаги-для-подключения-программы-к-базе-данных)
+ [12. Как используется JDBC DriverManager class?](#12-Как-используется-JDBC-DriverManager-class)
+ [13. Как получить информацию о сервере базы данных из java программы?](#13-Как-получить-информацию-о-сервере-базы-данных-из-java-программы)
+ [14. Что такое JDBC Statement?](#14-Что-такое-JDBC-Statement)
+ [15. Какие различия между execute, executeQuery, executeUpdate?](#15-Какие-различия-между-execute-executeQuery-executeUpdate)
+ [16. Что такое JDBC PreparedStatement?](#16-Что-такое-JDBC-PreparedStatement)
+ [17. Как установить NULL значения в JDBC PreparedStatement?](#17-Как-установить-NULL-значения-в-JDBC-PreparedStatement)
+ [18. Как используется метод getGeneratedKeys в Statement?](#18-Как-используется-метод-getGeneratedKeys-в-Statement)
+ [19. Какие преимущества в использовании PreparedStatement над Statement?](#19-Какие-преимущества-в-использовании-PreparedStatement-над-Statement)
+ [20. Какие есть ограничения PreparedStatement и как их преодолеть?](#20-Какие-есть-ограничения-PreparedStatement-и-как-их-преодолеть)
+ [21. Что такое JDBC ResultSet?](#21-Что-такое-JDBC-ResultSet)
+ [22. Какие существуют различные типы JDBC ResultSet?](#22-Какие-существуют-различные-типы-JDBC-ResultSet)
+ [23. Как используются методы setFetchSize и SetMaxRows в Statement?](#23-Как-используются-методы-setFetchSize-и-SetMaxRows-в-Statement)
+ [24. Как вызвать Stored Procedures используя JDBC API?](#24-Как-вызвать-Stored-Procedures-используя-JDBC-API)
+ [25. Что такое JDBC Batch Processing и каковы его преимущества?](#25-Что-такое-JDBC-Batch-Processing-и-каковы-его-преимущества)
+ [26. Что такое JDBC Transaction Management и зачем он нужен?](#26-Что-такое-JDBC-Transaction-Management-и-зачем-он-нужен)
+ [27. Как откатить JDBC транзакцию?](#27-Как-откатить-JDBC-транзакцию)
+ [28. Что такое JDBC Savepoint и как он используется?](#28-Что-такое-JDBC-Savepoint-и-как-он-используется)
+ [29. Расскажите о JDBC DataSource. Какие преимущества он дает?](#29-Расскажите-о-JDBC-DataSource-Какие-преимущества-он-дает)


## 1 Что такое первичный ключ

**Первичный ключ (primary key)** в реляционной модели данных один из потенциальных ключей отношения, выбранный в качестве 
основного ключа (ключа по умолчанию).
Если в отношении имеется единственный потенциальный ключ, он является и первичным ключом. 
Если потенциальных ключей несколько, один из них выбирается в качестве первичного, а другие называют «альтернативными».
В качестве первичного обычно выбирается тот из потенциальных ключей, который наиболее удобен. 
Поэтому в качестве первичного ключа, как правило, выбирают тот, который имеет наименьший размер (физического хранения) 
и/или включает наименьшее количество атрибутов. Другой критерий выбора первичного ключа — сохранение его уникальности 
со временем. Поэтому в качестве первичного ключа стараются выбирать такой потенциальный ключ, который 
с наибольшей вероятностью никогда не утратит уникальность.

[к оглавлению](#SQL)

## 2 Что такое внешний ключ

**Внешний ключ (foreign key)** —  это столбец или комбинация столбцов, значения которых соответствуют 
Первичному ключу в другой таблице. Связь между двумя таблицами задается через соответствие Первичного ключа в одной 
из таблиц внешнему ключу во второй.

[к оглавлению](#SQL)

## 3 Что такое нормализация БД

Нормализация - это процесс преобразования отношений базы данных к виду, отвечающему нормальным формам (пошаговый, 
обратимый процесс замены исходной схемы другой схемой, в которой наборы данных имеют более простую и логичную структуру).
Нормализация предназначена для приведения структуры базы данных к виду, обеспечивающему минимальную логическую 
избыточность, и не имеет целью уменьшение или увеличение производительности работы или же уменьшение или увеличение 
физического объёма базы данных. Конечной целью нормализации является уменьшение потенциальной противоречивости хранимой 
в базе данных информации.

[к оглавлению](#SQL)

## 4 Что такое денормализация БД Для чего она нужна

 Добавление "избыточных" данных с целью:

1. Для сохранения истории.
2. Повышение производительности запросов за счет экономии на объединениях.
3. Предварительные вычисления часто запрашиваемых значений.

[к оглавлению](#SQL)

## 5 Что такое кластерный и некластерный индекс

Записи на диске будут храниться в порядке их следования в таблице.

[к оглавлению](#SQL)

## 6 Какие типы соединений join таблиц существуют В чем их разница

INNER JOIN Выбираются только совпадающие данные из объединяемых таблиц.
OUTER JOIN Такое объединение вернет совпадающие данные из объединяемых таблиц ПЛЮС дополнит выборку оставшимися данными 
из внешней таблицы, которые по условию не подходят, заполнив недостающие данные значением NULL.
Существует два типа внешнего объединения OUTER JOIN - LEFT OUTER JOIN и RIGHT OUTER JOIN. 
FULL JOIN возвращает `объединение` объединений LEFT и RIGHT таблиц, комбинируя результат двух запросов.
CROSS JOIN возвращает перекрестное (декартово) объединение двух таблиц. Результатом будет выборка всех записей первой 
таблицы объединенная с каждой строкой второй таблицы. Важным моментом является то, что для кросса не нужно указывать 
условие объединения.
SELF JOIN соединение таблицы с этой же таблице.


При использовании объединения новички часто забывают что результирующая выборка может содержать дублирующиеся данные!

Статья про join: http://www.skillz.ru/dev/php/article-Obyasnenie_SQL_obedinenii_JOIN_INNER_OUTER.html

[к оглавлению](#SQL)

## 7 Что такое SQL курсор

Это эффективный способ получать большие наборы строк из функций по частям. 
Если выборка осуществляется через курсорные переменные, которые всегда имеют специальный тип данных refcursor.

[к оглавлению](#SQL)

## 8 Опишите шаги по созданию и использованию курсора

Объявить курсорную переменную.
1. Открыть курсор.
3. Работать с курсором необязательно в той же функции, где он был открыт.
4. Чтобы освободить ресурсы раньше, чем закончится транзакция можно использовать CLOSE cursor

[к оглавлению](#SQL)

## 10 Что такое транзакция

Связывание нескольких шагов в одну операцию.

[к оглавлению](#SQL)

## 11 Что такое триггер Какие типы триггеров вы знаете

Триггеры — это части кода, запускаемые автоматически и основанные на каком-либо действии или событии в таблице 
базы данных.
 
Триггеры могут применять в таблице во время выполнения операторов INSERT, UPDATE или DELETE, а затем работать 
или перед, или после этих действий.
 
Некоторые СУБД также позволяют работать триггерам на уровне оператора или на уровне каждой строки данных во 
время ее изменения.

[к оглавлению](#SQL)

## 12 В чем разница между WHERE и HAVING

WHERE - сначала отбирает сторки а потом применяет к ним GROUP BY и агрегатные функции типа COUNT(*)

HAVING - наоборот сначала все функции и группировки а потом выборка

[к оглавлению](#SQL)

## 13 Что такое подзапрос sub query

Запрос который выполнится перед основным и результаты которого будут теми данными из которых будет дальнейшая обработка 
основным запросом.

[к оглавлению](#SQL)

## 14 Что такое union

В языке SQL операция UNION применяется для объединения двух наборов строк, возвращаемых SQL-запросами. 
Оба запроса должны возвращать одинаковое число столбцов, и столбцы с одинаковым порядковым номером должны иметь 
совместимые типы данных. Результат получает структуру (названия и типы столбцов) первого (левого) запроса, то есть 
операция не является симметричной.
При объединении нескольких запросов подряд результат последовательно вычисляется слева направо.

[к оглавлению](#SQL)

## 15 Что такое group by

Фраза GROUP BY (группировать по) инициирует перекомпоновку указанной во FROM таблицы по группам, 
каждая из которых имеет одинаковые значения в столбце, указанном в GROUP BY.

[к оглавлению](#SQL)

## 17 Что такое хранимые процедуры

Объект базы данных, представляющий собой набор SQL-инструкций, который компилируется один раз и хранится на сервере. 
Хранимые процедуры очень похожи на обыкновенные процедуры языков высокого уровня, у них могут быть входные и выходные 
параметры и локальные переменные, в них могут производиться числовые вычисления и операции над символьными данными, 
результаты которых могут присваиваться переменным и параметрам. В хранимых процедурах могут выполняться стандартные 
операции с базами данных (как DDL, так и DML). Кроме того, в хранимых процедурах возможны циклы и ветвления, 
то есть в них могут использоваться инструкции управления процессом исполнения.
Хранимые процедуры похожи на определяемые пользователем функции (UDF). Основное различие заключается в том, 
что пользовательские функции можно использовать как и любое другое выражение в SQL запросе, в то время как 
хранимые процедуры должны быть вызваны с помощью функции CALL:
```sql
CALL процедура(…)
```
или
```sql
EXECUTE процедура(…)
```
Хранимые процедуры могут возвращать множества результатов, то есть результаты запроса SELECT. 
Такие множества результатов могут обрабатываться, используя курсоры, другими сохранёнными процедурами, 
возвращая указатель результирующего множества, либо же приложениями. Хранимые процедуры могут также содержать 
объявленные переменные для обработки данных и курсоров, которые позволяют организовать цикл по нескольким 
строкам в таблице. Стандарт SQL предоставляет для работы выражения IF, LOOP, REPEAT, CASE и многие другие. 
Хранимые процедуры могут принимать переменные, возвращать результаты или изменять переменные и возвращать их, 
в зависимости от того, где переменная объявлена.

[к оглавлению](#SQL)

## 18 Что такое view Представление

Виртуальная (логическая) таблица, представляющая собой поименованный запрос (синоним к запросу), который будет 
подставлен как подзапрос при использовании представления.
В отличие от обычных таблиц реляционных баз данных, представление не является самостоятельной частью набора данных, 
хранящегося в базе. Содержимое представления динамически вычисляется на основании данных, находящихся в реальных таблицах. 
Изменение данных в реальной таблице базы данных немедленно отражается в содержимом всех представлений, построенных на 
основании этой таблицы.

[к оглавлению](#SQL)

## 19 Опишите процесс создания запроса через JDBC



[к оглавлению](#SQL)

## 20 Для чего используется конструкция try with resources



[к оглавлению](#SQL)


## 1 ANSI SQL

SQL (structured query language — «язык структурированных запросов») — формальный непроцедурный язык программирования, 
применяемый для создания, модификации и управления данными в произвольной реляционной базе данных, управляемой 
соответствующей системой управления базами данных (СУБД). SQL основывается на исчислении кортежей. Стандарт SQL 
определяется с помощью кода ANSI.

[к оглавлению](#SQL)

## 2 Основные элементы баз данных – таблицы процедуры функции констрейнты и тд

**Поле** — это минимальный элемент базы данных, содержащий один неделимый квант информации. 
Каждое поле характеризуется именем и типом хранящихся в нем данных.

**Запись** — это совокупность нескольких разнородных полей, описывающая некоторую сущность предметной области.

**Таблица базы данных** — это набор однородных записей.

**Хранимая процедура** — объект базы данных, представляющий собой набор SQL-инструкций, который компилируется один раз
 и хранится на сервере. Хранимые процедуры очень похожи на обыкновенные процедуры языков высокого уровня, 
 у них могут быть входные и выходные параметры и локальные переменные, в них могут производиться числовые вычисления 
 и операции над символьными данными, результаты которых могут присваиваться переменным и параметрам. 
 В хранимых процедурах могут выполняться стандартные операции с базами данных (как DDL, так и DML). 
 Кроме того, в хранимых процедурах возможны циклы и ветвления, то есть в них могут использоваться инструкции 
 управления процессом исполнения.
```sql
CREATE [OR REPLACE] PROCEDURE имя_процедуры
[ (параметр [, параметр, …]) ] IS
            [локальные объявления]
        BEGIN
            исполняемые предложения
        [EXCEPTION
            обработчики исключений]
        END [имя_процедуры];
```
**Функция** – это подпрограмма, которая вычисляет значение. 
Существует большое количество встроенных функций (могут разниться для разных БД).
```sql
CREATE [OR REPLACE] FUNCTION имя_функции
[ (параметр [, параметр, …]) ]
RETURN тип_данных IS | AS
            [локальные объявления]
        BEGIN
            исполняемые предложения
        [EXCEPTION
            обработчики исключений]
        END [имя_функции];
```

**Констрейнты (constraints)** — объявление правил (ограничения), которым должны соответствовать данные в таблице.
```sql
CREATE TABLE table_name
(
column_name1 data_type(size) constraint_name,
column_name2 data_type(size) constraint_name,
column_name3 data_type(size) constraint_name,
....
);
Например для задания первичного ключа, можно использовать такую запись:
CONSTRAINT <имя ограничения> PRIMARY KEY (<список столбцов, являющихся первичным ключом>)
```

Типы констрейнтов:

+ NOT NULL -колонка не может содержать NULL значений.
+ UNIQUE — каждая строка в колонке должна иметь уникальное значение.
+ PRIMARY KEY — комбинация NOT NULL и UNIQUE.
+ FOREIGN KEY — обеспечивает ссылочную целостность. Означает что ссылающиеся данные имеют соответствие в другой таблице.
+ CHECK — проверка на определенное выполнение правил.
+ DEFAULT — задает значение по умолчанию для колонки

[к оглавлению](#SQL)

## 3 Как вы понимаете null в базах данных

Смысл NULL-значения — это отсутствие информации или неприменимость данного атрибута в данном кортеже.
NULL-значение может означать неприменимость значения к этому столбцу (например в колонке «скорость полета» для таблицы животные и записи «Слон»)
NULL-значение так же может означать отсутствие информации. Заменять отсутствующие значения, например на -1, ‘ ‘ или что-то такое, не корректно.

[к оглавлению](#SQL)

## 4 Агрегатные функции как они работают с null Не забудьте о group by и having

Стандартом предусмотрены следующие агрегатные функции:

+ COUNT(*)	Возвращает количество строк источника записей
+ COUNT	Возвращает количество значений в указанном столбце
+ SUM	Возвращает сумму значений в указанном столбце
+ AVG	Возвращает среднее значение в указанном столбце
+ MIN	Возвращает минимальное значение в указанном столбце
+ MAX	Возвращает максимальное значение в указанном столбце

Все эти функции возвращают единственное значение. При этом функции COUNT, MIN и MAX применимы к данным любого типа, 
в то время как SUM и AVG используются только для данных числового типа. Разница между функцией COUNT(*) 
и COUNT(имя столбца | выражение) состоит в том, что вторая (как и остальные агрегатные функции) при подсчете 
не учитывает NULL-значения.

Предложение GROUP BY используется для определения групп выходных строк, к которым могут применяться агрегатные 
функции (COUNT, MIN, MAX, AVG и SUM).

Если предложение WHERE определяет предикат для фильтрации строк, то предложение HAVING применяется после группировки для
определения аналогичного предиката, фильтрующего группы по значениям агрегатных функций. 
Это предложение необходимо для проверки значений, которые получены с помощью агрегатной функции не из отдельных строк 
источника записей, определенного в предложении FROM, а из групп таких строк. Поэтому такая проверка не может содержаться 
в предложении WHERE.

[к оглавлению](#SQL)

## 5 Каким образом лучше добавлять большое количество записей в таблицу

+ Отключить автокоммит.
+ Выполнить insert.
+ Закоммитить вручную.
+ Включить автокоммит.

[к оглавлению](#SQL)

## 6 Что такое первая нормальная форма и процесс нормализации Какие бывают нормальные формы

Первая нормальная форма (1NF) — базовая нормальная форма отношения в реляционной модели данных.

Нормальная форма — свойство отношения в реляционной модели данных, характеризующее его с точки зрения избыточности, 
потенциально приводящей к логически ошибочным результатам выборки или изменения данных. 
Нормальная форма определяется как совокупность требований, которым должно удовлетворять отношение. 
Нормальные формы: первая нормальная форма, вторая нормальная форма, третья нормальная форма, 
нормальная форма Бойса — Кодда, четвёртая нормальная форма, пятая нормальная форма.



[к оглавлению](#SQL)

## 7 В чем смысл индекса СУБД как они устроены как хранятся Как бы вы реализовали тот же функционал

Индекс (англ. index) — объект базы данных, создаваемый с целью повышения производительности поиска данных. 
Таблицы в базе данных могут иметь большое количество строк, которые хранятся в произвольном порядке, 
и их поиск по заданному критерию путем последовательного просмотра таблицы строка за строкой может занимать много времени. 
Индекс формируется из значений одного или нескольких столбцов таблицы и указателей на соответствующие строки таблицы и, 
таким образом, позволяет искать строки, удовлетворяющие критерию поиска. Ускорение работы с использованием индексов 
достигается в первую очередь за счёт того, что индекс имеет структуру, оптимизированную под поиск — например, 
сбалансированного дерева.

Обзор типов индексов Oracle, MySQL, PostgreSQL, MS SQL: http://habrahabr.ru/post/102785/

[к оглавлению](#SQL)

## 8 Что такое JDBC API и когда его используют

JDBC – это стандарт взаимодействия приложения с различными СУБД. JDBC основан на концепции драйверов, 
позволяющей получать соединение с БД по специальному url. JDBC API находятся в пакетах java.sql и javax.sql. 
С помощью JDBC API можно создавать соединения с БД, выполнять SQL запросы, хранимые процедуры и обрабатывать результаты. 
JDBC API упрощает работу с базами данных из Java программ.

[к оглавлению](#SQL)

## 9 Что такое JDBC Driver и какие различные типы драйверов JDBC вы знаете

JDBC основан на концепции так называемых драйверов, позволяющих получать соединение с базой данных по специально 
описанному URL. Драйверы могут загружаться динамически (во время работы программы). Загрузившись, 
драйвер сам регистрирует себя и вызывается автоматически, когда программа требует URL, содержащий протокол, 
за который драйвер отвечает.

[к оглавлению](#SQL)

## 10 Как JDBC API помогает достичь слабой связи между Java программой и JDBC Drivers API

JDBC API используют рефлексию в java для достижения слабой связи между джава программой и JDBC драйверами. 
Драйвер фактически загружается один раз с помощью Class.forName(), а дальше используются возможности JDBC API в Java. 
Таким образом мы пишем код не особо задумываясь с какой базой данных мы будем работать. 
При необходимости достаточно указать другой драйвер и не переписывать большое количество кода.

[к оглавлению](#SQL)

## 11 Что такое JDBC Connection Покажите шаги для подключения программы к базе данных

JDBC Connection — соединение, установленное с сервером базы данных. 
Это своего рода сессия или Socket Connection. Для создания JDBC connection требуется всего два шага:
1) Зарегистрировать и загрузить драйвер с помощью Class.forName(). Класс драйвера будет зарегистрирован для DriverManager 
и загружен в память.
2) Используя DriverManager.getConnection() получить объект Connection. 
В метод необходимо передать URL базы данных, имя и пароль.
```sql
Connection con = null;
try{
    // load the Driver Class
    Class.forName("com.mysql.jdbc.Driver");
 
    // create the connection now
    con = DriverManager.getConnection("jdbc:mysql://localhost:3306/UserDB",
                    "pankaj",
                    "pankaj123");
    }catch (SQLException e) {
            System.out.println("Check database is UP and configs are correct");
            e.printStackTrace();
    }catch (ClassNotFoundException e) {
            System.out.println("Please include JDBC MySQL jar in classpath");
            e.printStackTrace();
    }
```
[к оглавлению](#SQL)

## 12 Как используется JDBC DriverManager class

JDBC DriverManager — фабрика, через которую можно получить объект Database Connection. 
После загрузки JDBC драйвера в память, он регистрирует себя в DriverManager (что можно проверить посмотрев в исходники 
JDBC Driver class). DriverManager используется для получения подключения с помощью зарегистрированных драйверов 
(метод getConnection()).

[к оглавлению](#SQL)

## 13 Как получить информацию о сервере базы данных из java программы

С помощью объекта интерфейса DatabaseMetaData можно получить детальную информацию о сервере. 
После подключения к БД мы можем вызывать метод getMetaData() и получить объект DatabaseMetaData. 
Существует множество методов для получения различной информации, например о версии БД, конфигурации и т.п.
```sql
DatabaseMetaData metaData = con.getMetaData();
String dbProduct = metaData.getDatabaseProductName();
```
[к оглавлению](#SQL)

## 14 Что такое JDBC Statement

JDBC API Statement используется для выполнения SQL запросов к базе данных. 
Объект Statement можно получить с помощью метода Connection.getStatement(). 
Вызывая методы execute(), executeQuery(), executeUpdate() и др., можно выполнять различные статичные SQL запросы.

В случае динамически созданных SQL запросов внутри java программы, когда введенные пользователем данные могут быть 
не проверенными, можно использовать SQL injection.

По умолчанию только один объект ResultSet для каждого Statement может быть открыт в одно и то же время. 
Таким образом, если необходимо работать с несколькими объектами ResultSet одновременно, мы должны использовать различные 
объекты Statement. Все execute() методы в интерфейсе Statement закроют текущий открытый объект ResultSet при выполнении.

[к оглавлению](#SQL)

## 15 Какие различия между execute executeQuery executeUpdate

Существует несколько способов выполнять SQL-запросы в зависимости от типа этого запроса. 
Для этого у интерфейса Statement существует три различных метода: executeQuery(), executeUpdate(), а так же execute(). 
Рассмотрим их отдельно.

Самый базовый метод executeQuery() необходим для запросов, результатом которых является один единственный набор значений, 
таких как у запросов SELECT. Возвращает ResultSet, который не может быть null даже если у результата запроса 
не было найдено значений.

Метод execute() используется, когда операторы SQL возвращают более одного набора данных, более одного счетчика обновлений 
или и то, и другое. Метод возвращает true, если результатом является ResultSet, как у запроса SELECT. Вернет false, 
если ResultSet отсутствует, например при запросах вида Insert, Update. С помощью методов getResultSet() мы можем получить 
ResultSet, а getUpdateCount() — количество обновленных записей.

Метод executeUpdate() используется для выполнения операторов INSERT, UPDATE или DELETE, а также для операторов 
DDL (Data Definition Language — язык определения данных), например, CREATE TABLE и DROP TABLE. 
Результатом оператора INSERT, UPDATE, или DELETE является модификация одной или более колонок в нуле или более строках таблицы. 
Метод executeUpdate() возвращает целое число, показывающее, сколько строк было модифицировано. 
Для выражений типа CREATE TABLE и DROP TABLE, которые не оперируют над строками, возвращаемое методом executeUpdate() 
значение всегда равно нулю.

Все методы выполнения SQL-запросов закрывают предыдущий набор результатов (result set) у данного объекта Statement. 
Это означает, что перед тем как выполнять следующий запрос над тем же объектом Statement, 
надо завершить обработку результатов предыдущего (ResultSet).

[к оглавлению](#SQL)

## 16 Что такое JDBC PreparedStatement

Объект PreparedStatement используется для выполнения прекомпилированных SQL-запросов с или без входных (IN) параметров. 
Мы можем использовать сеттеры для установки значений в запрос. Т.к. PreparedStatement является предкомпилированным, 
то он может быть эффективно использован множество раз. PreparedStatement считается лучшим выбором нежели Statement, т.к. 
он автоматически обрабатывает специальные символы, а так же предотвращает, так называемые, SQL injection attack 
(когда в запрос можно подставить свой код).

[к оглавлению](#SQL)

## 17 Как установить NULL значения в JDBC PreparedStatement

Используя метод setNull() для установки null переменной в качестве параметра. 
Этот метод принимает индекс и SQL тип в качестве аргументов: s.setNull(10, java.sql.Types.INTEGER);

[к оглавлению](#SQL)

## 18 Как используется метод getGeneratedKeys в Statement

Если в таблице используется автоматическая генерация ключей, то для их получения используется метод Statement getGeneratedKeys(), 
который вернет сгенерированный ключ.

[к оглавлению](#SQL)

## 19 Какие преимущества в использовании PreparedStatement над Statement

+ PreparedStatement позволяет предотвратить атаки типа SQL injection, т.к. он автоматически экранирует специальные символы.
+ PreparedStatement позволяет использовать динамические запросы с внедрением параметров.
+ PreparedStatement быстрее Statement. Это особенно заметно при частом использовании PreparedStatement 
или при использовании для вызова группы запросов.
+ PreparedStatement позволяет писать объектно ориентированный код с использованием сеттеров\геттеров. 
В то время при использовании Statement необходимо использовать конкатенацию строк для создания запроса. 
Для больших запросов конкатенация выглядит, как минимум, большой, а так же несет в себе большой риск ошибки в запросе.

[к оглавлению](#SQL)

## 20 Какие есть ограничения PreparedStatement и как их преодолеть

В PreparedStatement нельзя использовать напрямую запросы с IN (входными) параметрами. Есть некоторые обходные пути:

+ Выполнить Single Queries – низкая производительность и вообще не рекомендуется так делать.
+ Использовать Stored Procedure (хранимые процедуры) – являются специфичными для конкретной базы данных и следовательно 
плохи для приложений с возможностью подключения к различным БД.
+ Создание PreparedStatement Query динамически – это хорошее решение, но с потерей кэширования PreparedStatement.
+ Использование NULL в PreparedStatement Query – хорошее решение, если вы знаете максимальное число переменных IN. 
Можно расширить до использования неограниченного кол-во параметров с помощью разбиения на части.

[к оглавлению](#SQL)

## 21 Что такое JDBC ResultSet

JDBC ResultSet — интерфейс, объект которого создается в результате запроса к базе данных. 
Его можно представить в виде таблицы данных, которая была сформирована в ответ на запрос.
Объект ResultSet поддерживает курсор, который указывает на текущую строку данных. 
При инициализации курсор устанавливается до первой строки. Для движение по строкам используется метод next(). 
При наличии строк после текущей позиции, метод next() возвращает true, что можно использовать для итерации по таблице 
полученных результатов.

По умолчанию объект ResultSet не модифицируемый и поддерживает курсор, который способен только к движение вперед. 
Для обхода такого ограничения можно использовать следующую конструкцию, которая даст возможность двунаправленного 
движения по таблице, а так же возможности обновления:
```sql
Statement stmt = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,
                                   ResultSet.CONCUR_UPDATABLE);
```

Объект ResultSet автоматически закрывается при закрытии объекта, который его сгенерировал. 
Так же закрытие произойдет при повторном выполнении запроса или возврату результата из другого набора результатов.

Для использования геттера ResultSet можно использовать имя колонки или индекс, который начинается с 1.

[к оглавлению](#SQL)

## 22 Какие существуют различные типы JDBC ResultSet

При создании Statement можно задать различные типы получаемого ResultSet.

Три типа объектов ResultSet:

+ **ResultSet.TYPE_FORWARD_ONLY:** тип по умолчанию. Поддерживает движение курсора только в прямом направлении.
+ **ResultSet.TYPE_SCROLL_INSENSITIVE:** Двунаправленный курсор. Объект не чувствителен к изменениям, которые произошли с таблицей после получения результата.
+ **ResultSet.TYPE_SCROLL_SENSITIVE:** Двунаправленный курсор. Объект чувствителен к изменениям, которые произошли с базой данных после создания объекта ResultSet.

Два типа потокобезопасных объектов ResultSet:

+ **ResultSet.CONCUR_READ_ONLY:** Поддерживает только чтение (read only). Применяется по умолчанию.
+ **ResultSet.CONCUR_UPDATABLE:** Поддерживает метод ResultSet update для обновления строк в таблице данных.

[к оглавлению](#SQL)

## 23 Как используются методы setFetchSize и SetMaxRows в Statement

Для ограничения количества строк, которые может вернуть запрос, применяется метод setMaxRows(int i). 
Конечно, этот результат можно получить используя SQL запрос (например для MySQL существует команда LIMIT).

Для понимания метода setFetchSize() необходимо разобраться с работой Statement и ResultSet. 
Когда выполняется запрос к базе данных, результат обрабатывается и сохраняется в кэше базы данных и возвращается в виде ResultSet. 
ResultSet является курсором, которые ссылается на результат в базе данных. Теперь допустим мы имеем запрос, 
который возвращает 100 строк и мы установили setFetchSize(10). Теперь для каждого обращения к базе данных выделено только 10 строк 
и понадобится 10 запросов, чтобы получить все данные. Выбор оптимального количества fetchSize() может улучшить производительность 
выполнения большого кол-ва обращений к каждой строке и в случае большого количества строк в выходном результате.

Значение fetchSize можно указать внутри объекта Statement, но оно может быть переопределено в объекте ResultSet с помощью setFetchSize().

[к оглавлению](#SQL)

## 24 Как вызвать Stored Procedures используя JDBC API

Хранимые процедуры — это группы SQL запросов, которые компилируются в базе данных и могут быть вызваны с помощью JDBC API. 
Для вызова хранимых процедур используется объект CallableStatement. Нам необходимо задать параметры выхода OUT до выполнения CallableStatement.
```sql
CallableStatement stmt = con.prepareCall("{call insertEmployee(?,?,?,?,?,?)}");
stmt.setInt(1, id);
stmt.setString(2, name);
stmt.setString(3, role);
stmt.setString(4, city);
stmt.setString(5, country);
 
//register the OUT parameter before calling the stored procedure
stmt.registerOutParameter(6, java.sql.Types.VARCHAR);
              
stmt.executeUpdate();
```
[к оглавлению](#SQL)

## 25 Что такое JDBC Batch Processing и каковы его преимущества

Бывает необходимо выполнить сразу группу похожих запросов, например при загрузке данных из CSV файлов реляционной базы данных. 
Это можно сделать просто используя Statement или PreparedStatement для пошагового выполнения этих запросов. 
В JDBC API существует другая возможность, которая предоставляет возможность выполнить группу запросов за один раз. 
Выполнение такого рода задачи происходит с помощью JDBC API Batch Processing.

JDBC API поддерживает пакетную обработку с помощью методов addBatch() и executeBatch() у Statement и PreparedStatement. 
К преимуществам такого подхода относится более быстрая работа, т.к. вызовов к базе данных может быть существенно меньше.

[к оглавлению](#SQL)

## 26 Что такое JDBC Transaction Management и зачем он нужен

По умолчанию, при создании подключения к базе данных будет выбран auto-commit mode. 
Это означает, что при каждом выполнении запроса он будет подтвержден автоматически по завершению. 
Каждый SQL запрос является транзакционным и выполняя какие-либо DML или DDL запросы по их завершению изменения будут 
приняты (сохранены) базой данных. Если у нас есть необходимость отказываться от сохранения выполнения какого-либо 
запроса (или групп запросов) в случае, если что-то пошло не так, то мы можем воспользоваться поддержкой транзакций в JDBC API.

С помощью метода setAutoCommit(boolean flag) можно отключить авто коммит в конкретном соединении. 
Следует отметить, что при отключении auto-commit не одно изменение не будет сохранено в базе данных до вызова 
метода commit() и за этим необходимо следить. Сервер базы данных будет блокировать необходимую часть базы данных 
до подтверждения транзакции, а так как это ресурсоёмкая задача, то подтверждать транзакцию необходимо сразу после выполнения задачи.

[к оглавлению](#SQL)

## 27 Как откатить JDBC транзакцию

Для этого предусмотрен метод объекта Connection rollback(), который откатывает транзакцию. 
Будут отменены все изменения в транзакции и отменен lock базы данных от этого объекта Connection.

[к оглавлению](#SQL)

## 28 Что такое JDBC Savepoint и как он используется

JDBC Savepoint позволяет создавать «чекпоинты» в транзакции с помощью которых мы можем откатить не всю транзакцию целиком, 
а только часть до точки сохранения. Любая точка сохранения автоматически освобождается и становится недоступной после 
подтверждения транзакции или её роллбека. Откат к точке сохранения делает все последующие сейвы недоступными и к ним уже 
нельзя будет вернуться.

[к оглавлению](#SQL)

## 29 Расскажите о JDBC DataSource Какие преимущества он дает

JDBC DataSource является интерфейсом пакета javax.sql и является более продвинутым в сравнении с DriverManager 
для подключения к базе данных. Мы можем использовать DataSource для создания подключения к базе данных и реализацию 
класса драйвера, которая будет выполнять всю работу по поддержанию соединения. 
В дополнение к соединению через Database, DataSource предоставляет следующие дополнительные возможности:

+ Кэширование PreparedStatement для ускорения обработки запросов
+ Настройки Connection timeout
+ Возможности логирования
+ Порог максимального размера ResultSet
+ Поддержка Connection Pooling в контейнере сервлетов, использующий поддержку JNDI.

[к оглавлению](#SQL)

